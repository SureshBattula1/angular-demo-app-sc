<div class="class-view-container" *ngIf="!isLoading && classData">
  <!-- Action Bar -->
  <div class="action-bar">
    <button mat-button (click)="onBack()">
      <mat-icon>arrow_back</mat-icon>
      Back to List
    </button>
    <div class="action-buttons">
      <button mat-raised-button color="primary" (click)="onEdit()">
        <mat-icon>edit</mat-icon>
        Edit
      </button>
      <button mat-raised-button color="warn" (click)="onDelete()">
        <mat-icon>delete</mat-icon>
        Delete
      </button>
    </div>
  </div>

  <!-- Header Card -->
  <mat-card class="header-card">
    <mat-card-content>
      <div class="class-header">
        <div class="class-logo">
          <mat-icon class="logo-icon">class</mat-icon>
        </div>
        <div class="class-info">
          <h1 class="class-name">{{ classData.class_name }}</h1>
          <div class="class-meta">
            <span class="grade-badge">
              <mat-icon>school</mat-icon>
              Grade {{ classData.grade }}
            </span>
            <span class="section-badge" *ngIf="classData.section">
              <mat-icon>class</mat-icon>
              Section {{ classData.section }}
            </span>
            <span class="academic-year">
              <mat-icon>event</mat-icon>
              {{ classData.academic_year }}
            </span>
            <span class="room-number" *ngIf="classData.room_number">
              <mat-icon>room</mat-icon>
              Room {{ classData.room_number }}
            </span>
            <span class="status-badge" [class.active]="classData.is_active">
              <mat-icon>circle</mat-icon>
              {{ classData.is_active ? 'Active' : 'Inactive' }}
            </span>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Statistics Card -->
  <div class="stats-grid">
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-icon students">
          <mat-icon>people</mat-icon>
        </div>
        <div class="stat-details">
          <div class="stat-value">{{ classData.current_strength }}</div>
          <div class="stat-label">Current Students</div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-icon capacity">
          <mat-icon>event_seat</mat-icon>
        </div>
        <div class="stat-details">
          <div class="stat-value">{{ classData.capacity }}</div>
          <div class="stat-label">Total Capacity</div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-icon available">
          <mat-icon>done_all</mat-icon>
        </div>
        <div class="stat-details">
          <div class="stat-value">{{ getAvailableSeats() }}</div>
          <div class="stat-label">Available Seats</div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-icon occupancy" [ngClass]="getOccupancyColor()">
          <mat-icon>pie_chart</mat-icon>
        </div>
        <div class="stat-details">
          <div class="stat-value">{{ getOccupancyPercentage() }}%</div>
          <div class="stat-label">Occupancy</div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Details Section -->
  <div class="details-grid">
    <mat-card class="detail-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>info</mat-icon>
          Class Information
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="detail-row">
          <span class="detail-label">Class Name:</span>
          <span class="detail-value">{{ classData.class_name }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Grade:</span>
          <span class="detail-value">{{ classData.grade }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Section:</span>
          <span class="detail-value">{{ classData.section || 'N/A' }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Academic Year:</span>
          <span class="detail-value">{{ classData.academic_year }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Branch:</span>
          <span class="detail-value">{{ classData.branch?.name }} ({{ classData.branch?.code }})</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Room Number:</span>
          <span class="detail-value">{{ classData.room_number || 'Not Assigned' }}</span>
        </div>
        <div class="detail-row" *ngIf="classData.description">
          <span class="detail-label">Description:</span>
          <span class="detail-value">{{ classData.description }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Status:</span>
          <span class="detail-value" [class.text-success]="classData.is_active" [class.text-muted]="!classData.is_active">
            {{ classData.is_active ? 'Active' : 'Inactive' }}
          </span>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Capacity Details Card -->
    <mat-card class="detail-card capacity-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>people</mat-icon>
          Capacity Details
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="capacity-info">
          <div class="capacity-stat">
            <div class="capacity-label">Total Capacity</div>
            <div class="capacity-value primary">{{ classData.capacity }}</div>
          </div>
          <div class="capacity-stat">
            <div class="capacity-label">Current Strength</div>
            <div class="capacity-value accent">{{ classData.current_strength }}</div>
          </div>
          <div class="capacity-stat">
            <div class="capacity-label">Available Seats</div>
            <div class="capacity-value success">{{ getAvailableSeats() }}</div>
          </div>
        </div>

        <!-- Occupancy Bar -->
        <div class="occupancy-section">
          <div class="occupancy-label">
            <span>Occupancy</span>
            <span class="occupancy-percentage">{{ getOccupancyPercentage() }}%</span>
          </div>
          <mat-progress-bar 
            mode="determinate" 
            [value]="getOccupancyPercentage()" 
            [color]="getOccupancyColor()">
          </mat-progress-bar>
        </div>

        <!-- Class Teacher -->
        <div class="teacher-section" *ngIf="classData.classTeacher">
          <mat-divider></mat-divider>
          <div class="teacher-info">
            <mat-icon>person</mat-icon>
            <div>
              <div class="teacher-label">Class Teacher</div>
              <div class="teacher-name">
                {{ classData.classTeacher.first_name }} {{ classData.classTeacher.last_name }}
              </div>
              <div class="teacher-email">{{ classData.classTeacher.email }}</div>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>

<!-- Loading State -->
<div class="loading-container" *ngIf="isLoading">
  <mat-spinner diameter="50"></mat-spinner>
  <p>Loading class details...</p>
</div>

