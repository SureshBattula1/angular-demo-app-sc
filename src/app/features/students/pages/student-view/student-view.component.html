<div class="student-view-container" *ngIf="!isLoading && student">
  <!-- Action Bar -->
  <div class="action-bar">
    <button mat-button (click)="onBack()">
      <mat-icon>arrow_back</mat-icon>
      Back to List
    </button>
    <div class="action-buttons">
      <button mat-raised-button color="primary" (click)="onEdit()">
        <mat-icon>edit</mat-icon>
        Edit
      </button>
      <button mat-raised-button color="warn" (click)="onDelete()">
        <mat-icon>delete</mat-icon>
        Delete
      </button>
    </div>
  </div>

  <!-- Header Card -->
  <mat-card class="header-card">
    <mat-card-content>
      <div class="student-header">
        <div class="student-avatar">
          <mat-icon class="avatar-icon">person</mat-icon>
        </div>
        <div class="student-info">
          <h1 class="student-name">{{ getFullName() }}</h1>
          <div class="student-meta">
            <span class="admission-badge">
              <mat-icon>badge</mat-icon>
              {{ student.admission_number }}
            </span>
            <span class="grade-badge">
              <mat-icon>school</mat-icon>
              Grade {{ student.grade }} {{ student.section ? '- ' + student.section : '' }}
            </span>
            <span class="roll-badge" *ngIf="student.roll_number">
              <mat-icon>numbers</mat-icon>
              Roll: {{ student.roll_number }}
            </span>
            <span class="status-badge" [ngClass]="getStatusColor(student.student_status)">
              <mat-icon>circle</mat-icon>
              {{ student.student_status }}
            </span>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Details Grid -->
  <div class="details-grid">
    <!-- Personal Information -->
    <mat-card class="detail-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>person</mat-icon>
          Personal Information
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="detail-row">
          <span class="detail-label">Full Name:</span>
          <span class="detail-value">{{ getFullName() }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Email:</span>
          <span class="detail-value">{{ student.email }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Phone:</span>
          <span class="detail-value">{{ student.phone || 'N/A' }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Date of Birth:</span>
          <span class="detail-value">{{ student.date_of_birth | date }} (Age: {{ getAge() }})</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Gender:</span>
          <span class="detail-value">{{ student.gender }}</span>
        </div>
        <div class="detail-row" *ngIf="student.blood_group">
          <span class="detail-label">Blood Group:</span>
          <span class="detail-value">{{ student.blood_group }}</span>
        </div>
        <div class="detail-row" *ngIf="student.religion">
          <span class="detail-label">Religion:</span>
          <span class="detail-value">{{ student.religion }}</span>
        </div>
        <div class="detail-row" *ngIf="student.category">
          <span class="detail-label">Category:</span>
          <span class="detail-value">{{ student.category }}</span>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Academic Information -->
    <mat-card class="detail-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>school</mat-icon>
          Academic Information
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="detail-row">
          <span class="detail-label">Admission Number:</span>
          <span class="detail-value">{{ student.admission_number }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Admission Date:</span>
          <span class="detail-value">{{ student.admission_date | date }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Grade:</span>
          <span class="detail-value">{{ student.grade }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Section:</span>
          <span class="detail-value">{{ student.section || 'Not Assigned' }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Roll Number:</span>
          <span class="detail-value">{{ student.roll_number || 'Not Assigned' }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Academic Year:</span>
          <span class="detail-value">{{ student.academic_year }}</span>
        </div>
        <div class="detail-row" *ngIf="student.stream">
          <span class="detail-label">Stream:</span>
          <span class="detail-value">{{ student.stream }}</span>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Address Information -->
    <mat-card class="detail-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>home</mat-icon>
          Address Information
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="detail-row">
          <span class="detail-label">Current Address:</span>
          <span class="detail-value">{{ student.current_address }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">City:</span>
          <span class="detail-value">{{ student.city }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">State:</span>
          <span class="detail-value">{{ student.state }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">PIN Code:</span>
          <span class="detail-value">{{ student.pincode }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Country:</span>
          <span class="detail-value">{{ student.country }}</span>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Parent Information -->
    <mat-card class="detail-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>family_restroom</mat-icon>
          Parent Information
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="parent-section">
          <strong>Father:</strong>
          <div class="detail-row">
            <span class="detail-label">Name:</span>
            <span class="detail-value">{{ student.father_name }}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Phone:</span>
            <span class="detail-value">{{ student.father_phone }}</span>
          </div>
          <div class="detail-row" *ngIf="student.father_email">
            <span class="detail-label">Email:</span>
            <span class="detail-value">{{ student.father_email }}</span>
          </div>
          <div class="detail-row" *ngIf="student.father_occupation">
            <span class="detail-label">Occupation:</span>
            <span class="detail-value">{{ student.father_occupation }}</span>
          </div>
        </div>

        <mat-divider class="my-3"></mat-divider>

        <div class="parent-section">
          <strong>Mother:</strong>
          <div class="detail-row">
            <span class="detail-label">Name:</span>
            <span class="detail-value">{{ student.mother_name }}</span>
          </div>
          <div class="detail-row" *ngIf="student.mother_phone">
            <span class="detail-label">Phone:</span>
            <span class="detail-value">{{ student.mother_phone }}</span>
          </div>
          <div class="detail-row" *ngIf="student.mother_email">
            <span class="detail-label">Email:</span>
            <span class="detail-value">{{ student.mother_email }}</span>
          </div>
        </div>

        <mat-divider class="my-3" *ngIf="student.emergency_contact_name"></mat-divider>

        <div class="parent-section" *ngIf="student.emergency_contact_name">
          <strong>Emergency Contact:</strong>
          <div class="detail-row">
            <span class="detail-label">Name:</span>
            <span class="detail-value">{{ student.emergency_contact_name }}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Phone:</span>
            <span class="detail-value">{{ student.emergency_contact_phone }}</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>

<!-- Loading State -->
<div class="loading-container" *ngIf="isLoading">
  <mat-spinner diameter="50"></mat-spinner>
  <p>Loading student details...</p>
</div>
